[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Code Resources for MEC-24-1288",
    "section": "",
    "text": "Context\nThis resource contains the code used to generate and analyze data for publication MEC-24-1288.\n\nGlobal availability of plant DNA barcodes as genomic resources to support basic and policy-relevant biodiversity research\nAuthors: Tyler R. Kartzinel 1,2 , Hannah K. Hoff 1,2 , Timothy Divoll 3 , Bethan L. Littleford- Colquhoun 1,2 , Heidi Anderson 4 , Mary K. Burak 1,2 , Maria Kuzmina 5 , Paul M. Musili 6 , Haldre Rogers 7 , Alejandra J. Troncoso 8,9 , Rebecca Y. Kartzinel 1,10 .\n\n\n1 Department of Ecology, Evolution, & Organismal Biology, Brown University, Providence, RI 02912, USA\n\n\n2 Institute at Brown for Environment and Society, Brown University, Providence, RI 02912, USA\n\n\n3 Center for Computation and Visualization, Brown University, Providence, RI 02912, USA\n\n\n4 Yellowstone Center for Resources, Yellowstone National Park, Mammoth Hot Springs, Wyoming, USA\n\n\n5 Centre for Biodiversity Genomics, University of Guelph, Guelph, Ontario, Canada, N1G 2W1\n\n\n6 Botany Department, National Museums of Kenya, Nairobi, Kenya 00100\n\n\n7 Department of Fish and Wildlife Conservation, Virginia Tech, Blacksburg, VA 24061, USA\n\n\n8 Instituto de Ecología y Biodiversidad (IEB), Santiago, Chile\n\n\n9 Departamento de Biología, Universidad de La Serena, La Serena, Chile\n\n\n10 Brown University Herbarium, Brown University, Providence, RI 02912, USA\n\n\nEmail: tyler_kartzinel@brown.edu.\n\n\nData Availability: All data required to complete the analyses are included in Datasets S1-S3. Raw downloads from public data repositories will be archived as versions of record used in these analyses at Dryad.",
    "crumbs": [
      "Context"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "Introduction",
    "section": "",
    "text": "Four code notebooks were used in the analyses for this publication.\n\nBuilding the BOLD dataset\nGeographic coverage\nTaxonomic coverage\nCase-study in geographic coverage of site-based reference data",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "building_bold.html",
    "href": "building_bold.html",
    "title": "Building the BOLD dataset",
    "section": "",
    "text": "Building the BOLD dataset\nAdd rest of code notebook here and update text",
    "crumbs": [
      "Building global BOLD data",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Building the BOLD dataset</span>"
    ]
  },
  {
    "objectID": "geocov_figs1.html",
    "href": "geocov_figs1.html",
    "title": "Coverage by climatic zones",
    "section": "",
    "text": "Figure 1. Read in combtab dataset of global barcode data from BOLD and summarize.\nThis notebook will generate plots of geographic coverage of barcodes available on BOLD, in relation to climatic zones, and for several genetic markers. It also assesses contributions to BOLD by Project ID.\nWe trim dataframe outputs to the first two rows for demonstartion, but full dataframes will be generated and stored in the R environment when running the code from source.\ncombtab &lt;- read.csv(\"../data/BoldPhyla_to_Families_combtab_v4.csv\")\n#View(combtab_20240624)\n\ncombtab_2 &lt;- (unique(combtab$family_name))\nhead(combtab_2, 2)\n\n[1] \"Acanthaceae\" \"Achariaceae\"\n\nhead(unique(combtab$family_name), 2)\n\n[1] \"Acanthaceae\" \"Achariaceae\"\n\ncombtab_subset_barcodes &lt;- combtab %&gt;% subset(multi != \"---\" & multi != \"\")\nhead(combtab_subset_barcodes, 2)\n\n  X.1 X   processid               institution_storing phylum_taxID\n1   1 1   API120-12 Sri Ramaswamy Memorial University           12\n2   2 2 CANGI002-17      Museu Paraense Emilio Goeldi           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n1 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID  genus_name\n1 Acanthaceae              NA                     415894 Peristrophe\n2 Acanthaceae          264310   Acanthoideae      148534     Ruellia\n  species_taxID             species_name subspecies_taxID subspecies_name\n1        494465 Peristrophe bicalyculata               NA                \n2        632816          Ruellia inflata               NA                \n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n1                   NA                 NA  NA  NA                          NA\n2                   NA                 NA  NA  NA                          NA\n  elev country province_state region sector exactsite rbcL matK trnL ITS2\n1   NA                                                rbcL               \n2   NA  Brazil           Para                         rbcL matK       ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS\n1        rbcL---                               \n2 rbcL-matK--ITS                               \n\ncombtab_split_barcodes &lt;- strsplit(combtab$multi, \"-\")\nhead(combtab_split_barcodes, 2)\n\n[[1]]\n[1] \"rbcL\" \"\"     \"\"    \n\n[[2]]\n[1] \"rbcL\" \"matK\" \"\"     \"ITS\" \n\nhead(unlist(combtab_split_barcodes)[which(unlist(combtab_split_barcodes)!=\"\")], 2)\n\n[1] \"rbcL\" \"rbcL\"\n\nlength(which(unlist(combtab_split_barcodes)!=\"\"))\n\n[1] 372460\n\n# Convert blank cells to NA\ncombtab[combtab == \"\"] &lt;- NA\n\n# Count the number of barcodes per specimen\ncombtab$barcode_count &lt;- rowSums(!is.na(combtab[, c(\"rbcL\", \"matK\", \"trnL\", \"ITS2\")]))\n\n# Calculate the total number of barcodes across all rows\ntotal_barcodes &lt;- sum(combtab$barcode_count)\n\n# Display the results\n#View(combtab)\ntotal_barcodes\n\n[1] 373582\n\n# write combtab\ncombtab &lt;- combtab \nwrite.csv(combtab, \"combtab.csv\")\n\n# write out combtab here for supplementary/supporting information \nlength(unique(combtab$species_name))\n\n[1] 102887\n\nlength(unique(combtab$country))\n\n[1] 208\n\nlength(unique(combtab$family_name))\n\n[1] 651\n\nlength(unique(combtab$family_name))\n\n[1] 651\n\n# calculate % north of tropic of cancer, south of tropic of capricorn, and between the two \ncombtab_north_of_tropic_of_cancer &lt;- combtab %&gt;% subset(lat &gt; 23.4)\nhead(combtab_north_of_tropic_of_cancer, 2)\n\n    X.1   X   processid      institution_storing phylum_taxID   phylum_name\n106 152 152 GBVU4228-13 Mined from GenBank, NCBI           12 Magnoliophyta\n107 153 153 GBVX3812-15 Mined from GenBank, NCBI           12 Magnoliophyta\n    class_taxID    class_name order_taxID order_name family_taxID family_name\n106          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n107          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n    subfamily_taxID subfamily_name genus_taxID genus_name species_taxID\n106              NA           &lt;NA&gt;      554651 Clarkeasia        554652\n107              NA           &lt;NA&gt;      210661  Avicennia        641297\n             species_name subspecies_taxID subspecies_name collectiondate_start\n106 Clarkeasia parviflora               NA            &lt;NA&gt;                   NA\n107 Avicennia officinalis               NA            &lt;NA&gt;                   NA\n    collectiondate_end     lat     lon                      coord_source\n106                 NA 28.3009 84.1339 Coordinates from country centroid\n107                 NA 23.5863 81.1730 Coordinates from country centroid\n    coord_accuracy elev country province_state   region sector exactsite rbcL\n106             NA   NA   Nepal           &lt;NA&gt; Narayani   &lt;NA&gt;      &lt;NA&gt; rbcL\n107             NA   NA   India           &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; &lt;NA&gt;\n    matK trnL ITS2   multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count\n106 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1\n107 matK &lt;NA&gt; &lt;NA&gt; -matK--    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1\n\ncombtab_south_of_tropic_of_capricorn &lt;- combtab %&gt;% subset(lat &lt; -23.4)\nhead(combtab_south_of_tropic_of_capricorn, 2)\n\n   X.1  X   processid\n48  55 55 GBVU4382-13\n52  60 60  KNPA505-09\n                                                        institution_storing\n48                                                 Mined from GenBank, NCBI\n52 University of Johannesburg, Department of Botany and Plant Biotechnology\n   phylum_taxID   phylum_name class_taxID    class_name order_taxID order_name\n48           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n52           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n   family_taxID family_name subfamily_taxID subfamily_name genus_taxID\n48       148533 Acanthaceae              NA           &lt;NA&gt;      554845\n52       148533 Acanthaceae              NA           &lt;NA&gt;      205058\n   genus_name species_taxID               species_name subspecies_taxID\n48 Petalidium        554846   Petalidium oblongifolium               NA\n52   Ruspolia        205059 Ruspolia hypocrateriformis               NA\n   subspecies_name collectiondate_start collectiondate_end      lat     lon\n48            &lt;NA&gt;                   NA                 NA -28.5536 24.7525\n52            &lt;NA&gt;                   NA                 NA -23.9440 31.7250\n                        coord_source coord_accuracy elev      country\n48 Coordinates from country centroid             NA   NA South Africa\n52                              &lt;NA&gt;             NA  208 South Africa\n   province_state region               sector\n48           &lt;NA&gt;   &lt;NA&gt;                 &lt;NA&gt;\n52        Limpopo   &lt;NA&gt; Kruger National Park\n                                            exactsite rbcL matK trnL ITS2\n48                                               &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;\n52 Kruger National Park, Nxanatseni region  North,  L rbcL matK &lt;NA&gt; &lt;NA&gt;\n         multi  gb_rbcL  gb_matK gb_trnL gb_ITS barcode_count\n48     rbcL--- FJ868916     &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1\n52 rbcL-matK-- KY632577 KY632577    &lt;NA&gt;   &lt;NA&gt;             2\n\ncombtab_between_cancer_capricorn &lt;- combtab %&gt;% subset(lat &gt;= -23.4 & lat &lt;= 23.4)\nhead(combtab_between_cancer_capricorn, 2)\n\n   X.1  X   processid            institution_storing phylum_taxID   phylum_name\n49  56 56 GENG1220-15 Gujarat Biodiversity Gene Bank           12 Magnoliophyta\n50  57 57 GENG1760-16 Gujarat Biodiversity Gene Bank           12 Magnoliophyta\n   class_taxID    class_name order_taxID order_name family_taxID family_name\n49          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n50          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n   subfamily_taxID  subfamily_name genus_taxID genus_name species_taxID\n49          480072 Thunbergioideae      273749 Thunbergia        317700\n50          264310    Acanthoideae      148534    Ruellia            NA\n             species_name subspecies_taxID subspecies_name collectiondate_start\n49 Thunbergia grandiflora               NA            &lt;NA&gt;                   NA\n50                   &lt;NA&gt;               NA            &lt;NA&gt;                   NA\n   collectiondate_end    lat    lon    coord_source coord_accuracy elev country\n49                 NA 22.306 73.278 Garmin etrax 10             NA  130   India\n50                 NA 21.615 70.505            &lt;NA&gt;             NA  532   India\n   province_state   region sector exactsite rbcL matK trnL ITS2   multi\n49        Gujarat Vodadara   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n50        Gujarat Junagadh   &lt;NA&gt;     Etava rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n    gb_rbcL gb_matK gb_trnL gb_ITS barcode_count\n49 KX641599    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1\n50 KJ535203    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1",
    "crumbs": [
      "Geographic coverage",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Coverage by climatic zones</span>"
    ]
  },
  {
    "objectID": "geocov_figs1.html#assess-project-contibutions.",
    "href": "geocov_figs1.html#assess-project-contibutions.",
    "title": "Coverage by climatic zones",
    "section": "Assess Project contibutions.",
    "text": "Assess Project contibutions.\nThis block will assess the localized sampling projects’ contributions to the overall BOLD database.\n\n# make container column \n# overall\nhead(combtab[grep(\"UHURU\", combtab$processid),], 2)\n\n   X.1  X   processid\n59  78 78 UHURU149-14\n60  82 82 UHURU394-14\n                                                                             institution_storing\n59 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n60 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n   phylum_taxID   phylum_name class_taxID    class_name order_taxID order_name\n59           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n60           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n   family_taxID family_name subfamily_taxID subfamily_name genus_taxID\n59       148533 Acanthaceae              NA           &lt;NA&gt;      148750\n60       148533 Acanthaceae              NA           &lt;NA&gt;      306313\n   genus_name species_taxID            species_name subspecies_taxID\n59   Justicia        591068 Justicia diclipteroides               NA\n60 Crossandra        659703     Crossandra massaica               NA\n   subspecies_name collectiondate_start collectiondate_end    lat     lon\n59            &lt;NA&gt;                   NA                 NA 0.4810 36.8740\n60            &lt;NA&gt;                   NA                 NA 0.2956 36.8824\n   coord_source coord_accuracy elev country province_state   region sector\n59         &lt;NA&gt;             NA 1650   Kenya    Rift Valley Laikipia   &lt;NA&gt;\n60         &lt;NA&gt;             NA 1650   Kenya    Rift Valley Laikipia   &lt;NA&gt;\n               exactsite rbcL matK trnL ITS2           multi  gb_rbcL  gb_matK\n59 Mpala Research Centre rbcL matK trnL &lt;NA&gt; rbcL-matK-trnL- KM255065 KM255065\n60 Mpala Research Centre rbcL matK trnL &lt;NA&gt; rbcL-matK-trnL- JX517979 JX517979\n    gb_trnL gb_ITS barcode_count\n59 KM255065   &lt;NA&gt;             3\n60 JX517979   &lt;NA&gt;             3\n\ncombtab$container&lt;-gsub(\"[0-9.-]\", \"\", combtab$processid)\nlength(unique(combtab$container))\n\n[1] 379\n\nsort(table(combtab$container), decreasing=T) #PNG, YNPBP, UHURU\n\n\nGBITS PGBMA  GBVX  GBVP   JWP  GBVA  GBVC  GBVU  GBVE  GBVS  GBVF  GBVW  GBVI \n70028 10890  8000  6694  6103  5270  4999  4989  4983  4983  4979  4959  4953 \n GBVM  GBVL  GBVG  GBVH  GBVK  GBVJ  GBVB  GBVD  GBVT  GBVR  SAFH  GBVO  GBVN \n 4939  4935  4920  4915  4898  4886  4870  4864  4854  4773  4271  3810  3668 \n GBVY BABRU POWNA  EBLF  GBVQ CPBOL  CRCZ   FCA  FBPL MHPAD   DPC   SDH UHURU \n 3629  3232  3174  3127  2863  2527  2450  2179  2143  2126  1780  1733  1720 \n GENG EDTOL  PNOR  KNPA VPSBC  FPUK PLOMA BRYCA IDRCG IPSUB TCAFR ABGCO MHPAF \n 1708  1581  1474  1339  1279  1240  1149  1125  1061   839   780   665   630 \nMKPCH  PLID CANGI GRASS   PNG SALIX YNPBP  BATT CALAK FSEUS GRDMO  AUSG MHPAC \n  622   590   564   553   551   540   527   520   508   502   498   479   448 \n  TRM MHPAA  TDEF  SCBI CANGA GCUDG PRTRE   KSR ALOAF   API FAUCT HOSAM   TSA \n  434   432   429   425   422   384   379   376   350   349   342   341   338 \n NNOR FPOON  KNPB  SBIO WABLK TRIOP   ALM ANGMD CSPPA VEMSH TMBRY NOVOA GRDTX \n  337   331   330   324   319   315   314   313   301   297   296   281   280 \n  FGB  PHAK GCUBG ITVPL APOSA PSYAF MXBZI TADCR CAATB   PIM POWNB CYPAF DBFZP \n  272   260   256   254   243   233   226   221   214   213   211   205   202 \nFYNBL   VPL RBTEP  FOND EGPAM MAPLT  PNCA HOLIN   POA BPTPS   ECU  ITVI MARQF \n  199   197   196   195   188   188   187   184   184   181   179   176   175 \nTRIKU BRYBC  CYAF IASVF HAIDA BBYUK  MADA    HB MXBTX BRALT  SERC   CPL  CPPB \n  175   174   173   172   170   164   164   160   160   159   159   157   148 \nPEPER   SAA  PLGE  BPNP GPAGA  KPLA  CROT ENDEM COBIN UGEAB  WREP MKTRT  FLSH \n  147   143   142   140   138   137   135   135   127   122   120   119   117 \nMADPL BSCAT   RBG PLKEN CAREX MKCRA CONOP NECLE DBMPP SFFIP   YHT   LWT   WAG \n  111   108   100    99    94    93    92    92    91    89    89    87    85 \nSASCH CREUA LEDCL LTRBN ZERGT  SLNM  OSCH  RUPL ORPOL LOPHZ POEUA RBPLT VPSEA \n   84    83    83    83    83    82    81    81    79    78    78    78    76 \nPLCHA  CRBS PCABL BRPLT KIFNE PANFT PLTHU  BTAM  GRII MEXCO PLNOR VLUZH KIFRH \n   75    74    74    73    72    70    69    68    68    68    63    63    62 \n BFAA COBIM  DBZN MLTVP  MPIN PLCOC RINGV  AGOP PLALG   SAP   AGL ATRIP  FSSM \n   61    60    60    60    60    60    58    55    55    55    54    54    54 \nPIPER  CERF  BAMP MIPDG ZPLPP   CSU DVHTF  DIDA   INB  SIDA SWFRG BRYUM  DBHI \n   53    51    50    50    49    48    47    46    46    46    46    44    44 \n CGII  MSTH JSUIS  HERB  IMDB KBGPP  NTDB KUDZU MKSAL CACRB IHGTI ITVRT TCHDC \n   43    43    42    41    40    40    40    39    39    38    36    36    35 \nKIFMO   THY  TNAU BBIHP CINCH INDET  PDBA  DBTS FERNO  FMED  SYKO PLNIP FAGRB \n   34    34    34    33    32    31    31    30    29    29    29    28    27 \nPLNIA LCBAR CACMK FFFCC MELIA   MBB PLWEL CRCBS PGLLP ACBRC AGMCV KIFHE   ATG \n   27    26    25    24    23    22    22    21    21    20    20    19    18 \n  BMS FQAGM SMPRS  CRCB GTICO TFOAX CRCBT PCUBC RBGEV AGVMK BBOBC  USMF   SDP \n   18    18    18    17    17    15    14    14    14    13    13    13    12 \nCACTB ITICS KIFAT MKOXY STRBS THYME ITVGA MHPAB NELKE PLCHU  PLNB PLPAR  PTOC \n   11    11    11    11    11    11    10    10    10    10    10    10    10 \n UADY AGVRB FAGMK  HRUC IMMEX  PMRB SABIO BBOTP LIVCA   MCT PCCMN PLTOR SEQLD \n   10     9     9     9     9     9     9     8     8     8     8     8     8 \n SPBL AUCAS CABAR RHEUM VASCB ALSEU BSRUG  DBTB  PHSN PLLAM   RBJ ABCBF ACCCO \n    8     7     7     7     7     6     6     6     6     6     6     5     5 \n BEER BHEPS CBIHP  DRAC IIPSA  MAHA  MPNE  MTSS NPOAF  PLON QUNAM RSUJO  SSAA \n    5     5     5     5     5     5     5     5     5     5     5     5     5 \n  CBL CSPPB EMPWG  RICE   BUL COMPL   GRJ ITICZ MSHQU  MTAT PCYMX  RJAS  AMBC \n    4     4     4     4     3     3     3     3     3     3     3     3     2 \nBCBSL  DCCC   GYM  HIMS  HRBC  KFRI LGRAS ORIGV PLPET PLSUD SEEWI  STRM SUSHI \n    2     2     2     2     2     2     2     2     2     2     2     2     2 \n  AKD   APP   ASJ DBALT  DLFW DMCSI DRCLS EOCCF  GUTB   ISO LAARS LADEE LAHAR \n    1     1     1     1     1     1     1     1     1     1     1     1     1 \nLAMSK MASMD MCAND MCBRT MCCAL MCGFB MCIII MCJNM MCMAN MCUII MCUKI MCVAD MCYMB \n    1     1     1     1     1     1     1     1     1     1     1     1     1 \n PCGM PLBRU PLMUS PLREN SDCCF SIDBG  SLAT   SLX  SPAP  SPAR   SRB THIPP  TRNT \n    1     1     1     1     1     1     1     1     1     1     1     1     1 \n  UMS   WKA \n    1     1 \n\n# for trnL\nlength(unique(combtab$container[which(combtab$trnL==\"trnL\")]))\n\n[1] 40\n\nsort(table(combtab$container[which(combtab$trnL==\"trnL\")]), decreasing=T) #PNG, YNPBP, UHURU\n\n\nUHURU BRYCA YNPBP   PNG TMBRY BRYBC  MADA BRALT HAIDA   YHT PANFT  DBZN KIFRH \n 1598  1125   502   496   296   174   164   159   144    89    70    60    51 \nEDTOL  MPIN  FOND BBIHP KIFMO SASCH  SAFH   SAA GTICO KIFAT SABIO IMMEX INDET \n   50    49    47    33    32    32    24    19    17    11     9     8     8 \nLIVCA   MCT MIPDG   LWT CBIHP   CBL EMPWG   TSA APOSA MKPCH  NNOR VASCB  FBPL \n    8     8     7     6     5     4     4     4     3     2     2     2     1 \nMKTRT \n    1 \n\n# percent of trnL sequences originating from top 5\nsum(sort(table(combtab$container[which(combtab$trnL==\"trnL\")]), decreasing=T)[1:5])/sum(sort(table(combtab$container[which(combtab$trnL==\"trnL\")]), decreasing=T)) \n\n[1] 0.7545079\n\n(sort(table(combtab$container[which(combtab$trnL==\"trnL\")]), decreasing=T)[1:5])/sum(sort(table(combtab$container[which(combtab$trnL==\"trnL\")]), decreasing=T)) \n\n\n     UHURU      BRYCA      YNPBP        PNG      TMBRY \n0.30015026 0.21130729 0.09429001 0.09316304 0.05559730 \n\n# number of specimen records mined from genbank \ncombtab_mined_from_genbank&lt;- subset (combtab, institution_storing == \"Mined from GenBank, NCBI\")\nhead(combtab_mined_from_genbank, 2)\n\n  X.1  X     processid      institution_storing phylum_taxID   phylum_name\n4  11 11 GBITS29777-21 Mined from GenBank, NCBI           12 Magnoliophyta\n5  12 12 GBITS29782-21 Mined from GenBank, NCBI           12 Magnoliophyta\n  class_taxID    class_name order_taxID order_name family_taxID family_name\n4          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n5          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n  subfamily_taxID subfamily_name genus_taxID genus_name species_taxID\n4              NA           &lt;NA&gt;      148601 Aphelandra        801590\n5              NA           &lt;NA&gt;      148601 Aphelandra       1100819\n            species_name subspecies_taxID subspecies_name collectiondate_start\n4      Aphelandra hylaea               NA            &lt;NA&gt;                   NA\n5 Aphelandra maximiliana               NA            &lt;NA&gt;                   NA\n  collectiondate_end lat lon coord_source coord_accuracy elev country\n4                 NA  NA  NA         &lt;NA&gt;             NA   NA    &lt;NA&gt;\n5                 NA  NA  NA         &lt;NA&gt;             NA   NA    &lt;NA&gt;\n  province_state region sector exactsite rbcL matK trnL ITS2  multi gb_rbcL\n4           &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  ITS #NAME?    &lt;NA&gt;\n5           &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  ITS #NAME?    &lt;NA&gt;\n  gb_matK gb_trnL gb_ITS barcode_count container\n4    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1     GBITS\n5    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1     GBITS\n\n# number of specimens in combtab identified to species\ncombtab_IDd_to_species &lt;- subset(combtab, species_name != \"\")\nhead(combtab_IDd_to_species, 2)\n\n  X.1 X   processid               institution_storing phylum_taxID\n1   1 1   API120-12 Sri Ramaswamy Memorial University           12\n2   2 2 CANGI002-17      Museu Paraense Emilio Goeldi           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n1 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID  genus_name\n1 Acanthaceae              NA           &lt;NA&gt;      415894 Peristrophe\n2 Acanthaceae          264310   Acanthoideae      148534     Ruellia\n  species_taxID             species_name subspecies_taxID subspecies_name\n1        494465 Peristrophe bicalyculata               NA            &lt;NA&gt;\n2        632816          Ruellia inflata               NA            &lt;NA&gt;\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n1                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n2                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n  elev country province_state region sector exactsite rbcL matK trnL ITS2\n1   NA    &lt;NA&gt;           &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;\n2   NA  Brazil           Para   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL matK &lt;NA&gt;  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n1        rbcL---    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1       API\n2 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3     CANGI\n\n# number of sequences mined from genbank \ncombtab_mined_from_genbank&lt;- subset (combtab, institution_storing == \"Mined from GenBank, NCBI\")\nhead(combtab_mined_from_genbank, 2)\n\n  X.1  X     processid      institution_storing phylum_taxID   phylum_name\n4  11 11 GBITS29777-21 Mined from GenBank, NCBI           12 Magnoliophyta\n5  12 12 GBITS29782-21 Mined from GenBank, NCBI           12 Magnoliophyta\n  class_taxID    class_name order_taxID order_name family_taxID family_name\n4          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n5          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n  subfamily_taxID subfamily_name genus_taxID genus_name species_taxID\n4              NA           &lt;NA&gt;      148601 Aphelandra        801590\n5              NA           &lt;NA&gt;      148601 Aphelandra       1100819\n            species_name subspecies_taxID subspecies_name collectiondate_start\n4      Aphelandra hylaea               NA            &lt;NA&gt;                   NA\n5 Aphelandra maximiliana               NA            &lt;NA&gt;                   NA\n  collectiondate_end lat lon coord_source coord_accuracy elev country\n4                 NA  NA  NA         &lt;NA&gt;             NA   NA    &lt;NA&gt;\n5                 NA  NA  NA         &lt;NA&gt;             NA   NA    &lt;NA&gt;\n  province_state region sector exactsite rbcL matK trnL ITS2  multi gb_rbcL\n4           &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  ITS #NAME?    &lt;NA&gt;\n5           &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;  ITS #NAME?    &lt;NA&gt;\n  gb_matK gb_trnL gb_ITS barcode_count container\n4    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1     GBITS\n5    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1     GBITS\n\ncombtab_mined_from_genbank[combtab_mined_from_genbank == \"\"] &lt;- NA # Convert blank cells to NA\ncombtab_mined_from_genbank$barcode_count_mined &lt;- rowSums(!is.na(combtab_mined_from_genbank[, c(\"rbcL\", \"matK\", \"trnL\", \"ITS2\")])) # Count the number of barcodes per specimen\ntotal_barcodes_mined &lt;- sum(combtab_mined_from_genbank$barcode_count_mined) # Calculate the total number of barcodes across all rows\n#View(combtab_mined_from_genbank)\ntotal_barcodes_mined\n\n[1] 199591\n\n# number of specimens in combtab with rbcL barcode \ncombtab_rbcL_barcodes &lt;- subset(combtab, rbcL != \"\")\nhead(combtab_rbcL_barcodes, 2)\n\n  X.1 X   processid               institution_storing phylum_taxID\n1   1 1   API120-12 Sri Ramaswamy Memorial University           12\n2   2 2 CANGI002-17      Museu Paraense Emilio Goeldi           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n1 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID  genus_name\n1 Acanthaceae              NA           &lt;NA&gt;      415894 Peristrophe\n2 Acanthaceae          264310   Acanthoideae      148534     Ruellia\n  species_taxID             species_name subspecies_taxID subspecies_name\n1        494465 Peristrophe bicalyculata               NA            &lt;NA&gt;\n2        632816          Ruellia inflata               NA            &lt;NA&gt;\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n1                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n2                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n  elev country province_state region sector exactsite rbcL matK trnL ITS2\n1   NA    &lt;NA&gt;           &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;\n2   NA  Brazil           Para   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL matK &lt;NA&gt;  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n1        rbcL---    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1       API\n2 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3     CANGI\n\n# number of specimens in combtab with matK barcode \ncombtab_matK_barcodes &lt;- subset(combtab, matK != \"\")\nhead(combtab_matK_barcodes, 2)\n\n  X.1 X   processid                       institution_storing phylum_taxID\n2   2 2 CANGI002-17              Museu Paraense Emilio Goeldi           12\n3   8 8 EBLF1456-22 Herbarium of South China Botanical Garden           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n3 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID    genus_name\n2 Acanthaceae          264310   Acanthoideae      148534       Ruellia\n3 Acanthaceae              NA           &lt;NA&gt;     1142731 Phlogacanthus\n  species_taxID           species_name subspecies_taxID subspecies_name\n2        632816        Ruellia inflata               NA            &lt;NA&gt;\n3       1142732 Phlogacanthus colaniae               NA            &lt;NA&gt;\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n2                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n3                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n  elev country province_state        region sector\n2   NA  Brazil           Para          &lt;NA&gt;   &lt;NA&gt;\n3  220   China        Guangxi Chongzuo City   &lt;NA&gt;\n                                           exactsite rbcL matK trnL ITS2\n2                                               &lt;NA&gt; rbcL matK &lt;NA&gt;  ITS\n3 Nonggang Protection Station-No.3 Boundary Tablet-L rbcL matK &lt;NA&gt;  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n2 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3     CANGI\n3 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3      EBLF\n\n# number of specimens in combtab with ITS barcode \ncombtab_ITS2_barcodes &lt;- subset(combtab, ITS2 != \"\")\nhead(combtab_ITS2_barcodes, 2)\n\n  X.1 X   processid                       institution_storing phylum_taxID\n2   2 2 CANGI002-17              Museu Paraense Emilio Goeldi           12\n3   8 8 EBLF1456-22 Herbarium of South China Botanical Garden           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n3 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID    genus_name\n2 Acanthaceae          264310   Acanthoideae      148534       Ruellia\n3 Acanthaceae              NA           &lt;NA&gt;     1142731 Phlogacanthus\n  species_taxID           species_name subspecies_taxID subspecies_name\n2        632816        Ruellia inflata               NA            &lt;NA&gt;\n3       1142732 Phlogacanthus colaniae               NA            &lt;NA&gt;\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n2                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n3                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n  elev country province_state        region sector\n2   NA  Brazil           Para          &lt;NA&gt;   &lt;NA&gt;\n3  220   China        Guangxi Chongzuo City   &lt;NA&gt;\n                                           exactsite rbcL matK trnL ITS2\n2                                               &lt;NA&gt; rbcL matK &lt;NA&gt;  ITS\n3 Nonggang Protection Station-No.3 Boundary Tablet-L rbcL matK &lt;NA&gt;  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n2 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3     CANGI\n3 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3      EBLF\n\n# number of specimens in combtab with trnL barcode \ncombtab_trnL_barcodes &lt;- subset(combtab, trnL != \"\")\nhead(combtab_trnL_barcodes, 2)\n\n   X.1  X   processid\n59  78 78 UHURU149-14\n60  82 82 UHURU394-14\n                                                                             institution_storing\n59 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n60 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n   phylum_taxID   phylum_name class_taxID    class_name order_taxID order_name\n59           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n60           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n   family_taxID family_name subfamily_taxID subfamily_name genus_taxID\n59       148533 Acanthaceae              NA           &lt;NA&gt;      148750\n60       148533 Acanthaceae              NA           &lt;NA&gt;      306313\n   genus_name species_taxID            species_name subspecies_taxID\n59   Justicia        591068 Justicia diclipteroides               NA\n60 Crossandra        659703     Crossandra massaica               NA\n   subspecies_name collectiondate_start collectiondate_end    lat     lon\n59            &lt;NA&gt;                   NA                 NA 0.4810 36.8740\n60            &lt;NA&gt;                   NA                 NA 0.2956 36.8824\n   coord_source coord_accuracy elev country province_state   region sector\n59         &lt;NA&gt;             NA 1650   Kenya    Rift Valley Laikipia   &lt;NA&gt;\n60         &lt;NA&gt;             NA 1650   Kenya    Rift Valley Laikipia   &lt;NA&gt;\n               exactsite rbcL matK trnL ITS2           multi  gb_rbcL  gb_matK\n59 Mpala Research Centre rbcL matK trnL &lt;NA&gt; rbcL-matK-trnL- KM255065 KM255065\n60 Mpala Research Centre rbcL matK trnL &lt;NA&gt; rbcL-matK-trnL- JX517979 JX517979\n    gb_trnL gb_ITS barcode_count container\n59 KM255065   &lt;NA&gt;             3     UHURU\n60 JX517979   &lt;NA&gt;             3     UHURU\n\n# number of genbank accession numbers in combtab \ncombtab_for_genbank &lt;- combtab\ncombtab_for_genbank[combtab_for_genbank == \"\"] &lt;- NA # Convert blank cells to NA\n\n# Count the number of barcodes per specimen (number of non-NA values per row in the specified columns)\ncombtab_for_genbank$accession_count &lt;- rowSums(!is.na(combtab_for_genbank[, c(\"gb_rbcL\", \"gb_matK\", \"gb_trnL\", \"gb_ITS\")]))\n\n# Calculate the total number of barcodes across all rows (sum of accession_count)\ntotal_accessions &lt;- sum(combtab_for_genbank$accession_count)\n\n# Display the results\n#View(combtab_for_genbank)\ntotal_accessions\n\n[1] 262920\n\n# number of specimens with country listed \ncombtab_countries &lt;- subset(combtab, country != \"\")\nhead(combtab_countries, 2)\n\n  X.1 X   processid                       institution_storing phylum_taxID\n2   2 2 CANGI002-17              Museu Paraense Emilio Goeldi           12\n3   8 8 EBLF1456-22 Herbarium of South China Botanical Garden           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n3 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID    genus_name\n2 Acanthaceae          264310   Acanthoideae      148534       Ruellia\n3 Acanthaceae              NA           &lt;NA&gt;     1142731 Phlogacanthus\n  species_taxID           species_name subspecies_taxID subspecies_name\n2        632816        Ruellia inflata               NA            &lt;NA&gt;\n3       1142732 Phlogacanthus colaniae               NA            &lt;NA&gt;\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n2                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n3                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n  elev country province_state        region sector\n2   NA  Brazil           Para          &lt;NA&gt;   &lt;NA&gt;\n3  220   China        Guangxi Chongzuo City   &lt;NA&gt;\n                                           exactsite rbcL matK trnL ITS2\n2                                               &lt;NA&gt; rbcL matK &lt;NA&gt;  ITS\n3 Nonggang Protection Station-No.3 Boundary Tablet-L rbcL matK &lt;NA&gt;  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n2 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3     CANGI\n3 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3      EBLF\n\n# number of specimens with lat/long listed \ncombtab_lat &lt;- subset(combtab, lat != \"\")\nhead(combtab_lat, 2)\n\n   X.1  X   processid            institution_storing phylum_taxID   phylum_name\n48  55 55 GBVU4382-13       Mined from GenBank, NCBI           12 Magnoliophyta\n49  56 56 GENG1220-15 Gujarat Biodiversity Gene Bank           12 Magnoliophyta\n   class_taxID    class_name order_taxID order_name family_taxID family_name\n48          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n49          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n   subfamily_taxID  subfamily_name genus_taxID genus_name species_taxID\n48              NA            &lt;NA&gt;      554845 Petalidium        554846\n49          480072 Thunbergioideae      273749 Thunbergia        317700\n               species_name subspecies_taxID subspecies_name\n48 Petalidium oblongifolium               NA            &lt;NA&gt;\n49   Thunbergia grandiflora               NA            &lt;NA&gt;\n   collectiondate_start collectiondate_end      lat     lon\n48                   NA                 NA -28.5536 24.7525\n49                   NA                 NA  22.3060 73.2780\n                        coord_source coord_accuracy elev      country\n48 Coordinates from country centroid             NA   NA South Africa\n49                   Garmin etrax 10             NA  130        India\n   province_state   region sector exactsite rbcL matK trnL ITS2   multi\n48           &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n49        Gujarat Vodadara   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n    gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n48 FJ868916    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1      GBVU\n49 KX641599    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1      GENG\n\ncombtab_lon &lt;- subset(combtab, lon != \"\")\nhead(combtab_lon, 2)\n\n   X.1  X   processid            institution_storing phylum_taxID   phylum_name\n48  55 55 GBVU4382-13       Mined from GenBank, NCBI           12 Magnoliophyta\n49  56 56 GENG1220-15 Gujarat Biodiversity Gene Bank           12 Magnoliophyta\n   class_taxID    class_name order_taxID order_name family_taxID family_name\n48          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n49          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n   subfamily_taxID  subfamily_name genus_taxID genus_name species_taxID\n48              NA            &lt;NA&gt;      554845 Petalidium        554846\n49          480072 Thunbergioideae      273749 Thunbergia        317700\n               species_name subspecies_taxID subspecies_name\n48 Petalidium oblongifolium               NA            &lt;NA&gt;\n49   Thunbergia grandiflora               NA            &lt;NA&gt;\n   collectiondate_start collectiondate_end      lat     lon\n48                   NA                 NA -28.5536 24.7525\n49                   NA                 NA  22.3060 73.2780\n                        coord_source coord_accuracy elev      country\n48 Coordinates from country centroid             NA   NA South Africa\n49                   Garmin etrax 10             NA  130        India\n   province_state   region sector exactsite rbcL matK trnL ITS2   multi\n48           &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n49        Gujarat Vodadara   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n    gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n48 FJ868916    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1      GBVU\n49 KX641599    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1      GENG\n\n# number of matK sequences\ncombtab_matK &lt;- subset(combtab, matK == \"matK\")\nhead(combtab_matK, 2)\n\n  X.1 X   processid                       institution_storing phylum_taxID\n2   2 2 CANGI002-17              Museu Paraense Emilio Goeldi           12\n3   8 8 EBLF1456-22 Herbarium of South China Botanical Garden           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n3 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID    genus_name\n2 Acanthaceae          264310   Acanthoideae      148534       Ruellia\n3 Acanthaceae              NA           &lt;NA&gt;     1142731 Phlogacanthus\n  species_taxID           species_name subspecies_taxID subspecies_name\n2        632816        Ruellia inflata               NA            &lt;NA&gt;\n3       1142732 Phlogacanthus colaniae               NA            &lt;NA&gt;\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n2                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n3                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n  elev country province_state        region sector\n2   NA  Brazil           Para          &lt;NA&gt;   &lt;NA&gt;\n3  220   China        Guangxi Chongzuo City   &lt;NA&gt;\n                                           exactsite rbcL matK trnL ITS2\n2                                               &lt;NA&gt; rbcL matK &lt;NA&gt;  ITS\n3 Nonggang Protection Station-No.3 Boundary Tablet-L rbcL matK &lt;NA&gt;  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n2 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3     CANGI\n3 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3      EBLF\n\n# number of matK sequences with lat/long data \ncombtab_matK_latlong &lt;- subset(combtab_matK, lat != \"\")\nhead(combtab_matK_latlong, 2)\n\n   X.1  X  processid\n51  58 58 IMDB014-14\n52  60 60 KNPA505-09\n                                                        institution_storing\n51             Birla Institute of Technology - Pilani, K.K.Birla Goa Campus\n52 University of Johannesburg, Department of Botany and Plant Biotechnology\n   phylum_taxID   phylum_name class_taxID    class_name order_taxID order_name\n51           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n52           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n   family_taxID family_name subfamily_taxID subfamily_name genus_taxID\n51       148533 Acanthaceae              NA           &lt;NA&gt;      390091\n52       148533 Acanthaceae              NA           &lt;NA&gt;      205058\n   genus_name species_taxID               species_name subspecies_taxID\n51   Acanthus        641300       Acanthus ilicifolius               NA\n52   Ruspolia        205059 Ruspolia hypocrateriformis               NA\n   subspecies_name collectiondate_start collectiondate_end      lat     lon\n51            &lt;NA&gt;                   NA                 NA  15.5256 73.8753\n52            &lt;NA&gt;                   NA                 NA -23.9440 31.7250\n   coord_source coord_accuracy elev      country province_state    region\n51         &lt;NA&gt;             NA   NA        India            Goa North Goa\n52         &lt;NA&gt;             NA  208 South Africa        Limpopo      &lt;NA&gt;\n                 sector                                          exactsite rbcL\n51      Mandovi estuary                                      Chorao Island rbcL\n52 Kruger National Park Kruger National Park, Nxanatseni region  North,  L rbcL\n   matK trnL ITS2       multi  gb_rbcL  gb_matK gb_trnL gb_ITS barcode_count\n51 matK &lt;NA&gt; &lt;NA&gt; rbcL-matK-- DQ028462 DQ028462    &lt;NA&gt;   &lt;NA&gt;             2\n52 matK &lt;NA&gt; &lt;NA&gt; rbcL-matK-- KY632577 KY632577    &lt;NA&gt;   &lt;NA&gt;             2\n   container\n51      IMDB\n52      KNPA\n\n# number of rbcL sequences\ncombtab_rbcL &lt;- subset(combtab, rbcL == \"rbcL\")\nhead(combtab_rbcL, 2)\n\n  X.1 X   processid               institution_storing phylum_taxID\n1   1 1   API120-12 Sri Ramaswamy Memorial University           12\n2   2 2 CANGI002-17      Museu Paraense Emilio Goeldi           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n1 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID  genus_name\n1 Acanthaceae              NA           &lt;NA&gt;      415894 Peristrophe\n2 Acanthaceae          264310   Acanthoideae      148534     Ruellia\n  species_taxID             species_name subspecies_taxID subspecies_name\n1        494465 Peristrophe bicalyculata               NA            &lt;NA&gt;\n2        632816          Ruellia inflata               NA            &lt;NA&gt;\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n1                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n2                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n  elev country province_state region sector exactsite rbcL matK trnL ITS2\n1   NA    &lt;NA&gt;           &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;\n2   NA  Brazil           Para   &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL matK &lt;NA&gt;  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n1        rbcL---    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1       API\n2 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3     CANGI\n\n# number of rbcL sequences with lat/long data \ncombtab_rbcL_latlong &lt;- subset(combtab_rbcL, lat != \"\")\nhead(combtab_rbcL_latlong, 2)\n\n   X.1  X   processid            institution_storing phylum_taxID   phylum_name\n48  55 55 GBVU4382-13       Mined from GenBank, NCBI           12 Magnoliophyta\n49  56 56 GENG1220-15 Gujarat Biodiversity Gene Bank           12 Magnoliophyta\n   class_taxID    class_name order_taxID order_name family_taxID family_name\n48          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n49          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n   subfamily_taxID  subfamily_name genus_taxID genus_name species_taxID\n48              NA            &lt;NA&gt;      554845 Petalidium        554846\n49          480072 Thunbergioideae      273749 Thunbergia        317700\n               species_name subspecies_taxID subspecies_name\n48 Petalidium oblongifolium               NA            &lt;NA&gt;\n49   Thunbergia grandiflora               NA            &lt;NA&gt;\n   collectiondate_start collectiondate_end      lat     lon\n48                   NA                 NA -28.5536 24.7525\n49                   NA                 NA  22.3060 73.2780\n                        coord_source coord_accuracy elev      country\n48 Coordinates from country centroid             NA   NA South Africa\n49                   Garmin etrax 10             NA  130        India\n   province_state   region sector exactsite rbcL matK trnL ITS2   multi\n48           &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n49        Gujarat Vodadara   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n    gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n48 FJ868916    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1      GBVU\n49 KX641599    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1      GENG\n\n# number of ITS sequences\ncombtab_ITS &lt;- subset(combtab, ITS2 == \"ITS\")\nhead(combtab_ITS, 2)\n\n  X.1 X   processid                       institution_storing phylum_taxID\n2   2 2 CANGI002-17              Museu Paraense Emilio Goeldi           12\n3   8 8 EBLF1456-22 Herbarium of South China Botanical Garden           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n3 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID    genus_name\n2 Acanthaceae          264310   Acanthoideae      148534       Ruellia\n3 Acanthaceae              NA           &lt;NA&gt;     1142731 Phlogacanthus\n  species_taxID           species_name subspecies_taxID subspecies_name\n2        632816        Ruellia inflata               NA            &lt;NA&gt;\n3       1142732 Phlogacanthus colaniae               NA            &lt;NA&gt;\n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n2                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n3                   NA                 NA  NA  NA         &lt;NA&gt;             NA\n  elev country province_state        region sector\n2   NA  Brazil           Para          &lt;NA&gt;   &lt;NA&gt;\n3  220   China        Guangxi Chongzuo City   &lt;NA&gt;\n                                           exactsite rbcL matK trnL ITS2\n2                                               &lt;NA&gt; rbcL matK &lt;NA&gt;  ITS\n3 Nonggang Protection Station-No.3 Boundary Tablet-L rbcL matK &lt;NA&gt;  ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n2 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3     CANGI\n3 rbcL-matK--ITS    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             3      EBLF\n\n# number of ITS sequences with lat/long data \ncombtab_ITS_latlong &lt;- subset(combtab_ITS, lat != \"\")\nhead(combtab_ITS_latlong, 2)\n\n   X.1  X    processid             institution_storing phylum_taxID\n53  62 62 MHPAD3203-10 Area de Conservacion Guanacaste           12\n54  65 65  MHPAD537-09 Area de Conservacion Guanacaste           12\n     phylum_name class_taxID    class_name order_taxID order_name family_taxID\n53 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n54 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n   family_name subfamily_taxID subfamily_name genus_taxID genus_name\n53 Acanthaceae              NA           &lt;NA&gt;      148750   Justicia\n54 Acanthaceae              NA           &lt;NA&gt;      148750   Justicia\n   species_taxID        species_name subspecies_taxID subspecies_name\n53        317738   Justicia brenesii               NA            &lt;NA&gt;\n54        204815 Justicia arborecens               NA            &lt;NA&gt;\n   collectiondate_start collectiondate_end    lat     lon coord_source\n53                   NA                 NA 10.905 -85.279         &lt;NA&gt;\n54                   NA                 NA 10.923 -85.465         &lt;NA&gt;\n   coord_accuracy elev    country province_state\n53             NA  410 Costa Rica       Alajuela\n54             NA 1039 Costa Rica     Guanacaste\n                            region            sector\n53 Area de Conservacion Guanacaste Rincon Rainforest\n54 Area de Conservacion Guanacaste      Sector Cacao\n                                    exactsite rbcL matK trnL ITS2\n53                             Sendero Rincon rbcL matK &lt;NA&gt;  ITS\n54 Estacion Biologica Cacao, Sendero Arenales rbcL matK &lt;NA&gt;  ITS\n            multi  gb_rbcL  gb_matK gb_trnL   gb_ITS barcode_count container\n53 rbcL-matK--ITS AB114507 AB114507    &lt;NA&gt; AB114507             3     MHPAD\n54 rbcL-matK--ITS AF188127 AF188127    &lt;NA&gt; AF188127             3     MHPAD\n\n# number of trnL sequences\ncombtab_trnL &lt;- subset(combtab, trnL == \"trnL\")\nhead(combtab_trnL, 2)\n\n   X.1  X   processid\n59  78 78 UHURU149-14\n60  82 82 UHURU394-14\n                                                                             institution_storing\n59 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n60 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n   phylum_taxID   phylum_name class_taxID    class_name order_taxID order_name\n59           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n60           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n   family_taxID family_name subfamily_taxID subfamily_name genus_taxID\n59       148533 Acanthaceae              NA           &lt;NA&gt;      148750\n60       148533 Acanthaceae              NA           &lt;NA&gt;      306313\n   genus_name species_taxID            species_name subspecies_taxID\n59   Justicia        591068 Justicia diclipteroides               NA\n60 Crossandra        659703     Crossandra massaica               NA\n   subspecies_name collectiondate_start collectiondate_end    lat     lon\n59            &lt;NA&gt;                   NA                 NA 0.4810 36.8740\n60            &lt;NA&gt;                   NA                 NA 0.2956 36.8824\n   coord_source coord_accuracy elev country province_state   region sector\n59         &lt;NA&gt;             NA 1650   Kenya    Rift Valley Laikipia   &lt;NA&gt;\n60         &lt;NA&gt;             NA 1650   Kenya    Rift Valley Laikipia   &lt;NA&gt;\n               exactsite rbcL matK trnL ITS2           multi  gb_rbcL  gb_matK\n59 Mpala Research Centre rbcL matK trnL &lt;NA&gt; rbcL-matK-trnL- KM255065 KM255065\n60 Mpala Research Centre rbcL matK trnL &lt;NA&gt; rbcL-matK-trnL- JX517979 JX517979\n    gb_trnL gb_ITS barcode_count container\n59 KM255065   &lt;NA&gt;             3     UHURU\n60 JX517979   &lt;NA&gt;             3     UHURU\n\n# number of ITS sequences with lat/long data \ncombtab_trnL_latlong &lt;- subset(combtab_trnL, lat != \"\")\nhead(combtab_trnL_latlong, 2)\n\n   X.1  X   processid\n59  78 78 UHURU149-14\n60  82 82 UHURU394-14\n                                                                             institution_storing\n59 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n60 Smithsonian Institution, National Museum of Natural History, United States National Herbarium\n   phylum_taxID   phylum_name class_taxID    class_name order_taxID order_name\n59           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n60           12 Magnoliophyta          41 Magnoliopsida      121216   Lamiales\n   family_taxID family_name subfamily_taxID subfamily_name genus_taxID\n59       148533 Acanthaceae              NA           &lt;NA&gt;      148750\n60       148533 Acanthaceae              NA           &lt;NA&gt;      306313\n   genus_name species_taxID            species_name subspecies_taxID\n59   Justicia        591068 Justicia diclipteroides               NA\n60 Crossandra        659703     Crossandra massaica               NA\n   subspecies_name collectiondate_start collectiondate_end    lat     lon\n59            &lt;NA&gt;                   NA                 NA 0.4810 36.8740\n60            &lt;NA&gt;                   NA                 NA 0.2956 36.8824\n   coord_source coord_accuracy elev country province_state   region sector\n59         &lt;NA&gt;             NA 1650   Kenya    Rift Valley Laikipia   &lt;NA&gt;\n60         &lt;NA&gt;             NA 1650   Kenya    Rift Valley Laikipia   &lt;NA&gt;\n               exactsite rbcL matK trnL ITS2           multi  gb_rbcL  gb_matK\n59 Mpala Research Centre rbcL matK trnL &lt;NA&gt; rbcL-matK-trnL- KM255065 KM255065\n60 Mpala Research Centre rbcL matK trnL &lt;NA&gt; rbcL-matK-trnL- JX517979 JX517979\n    gb_trnL gb_ITS barcode_count container\n59 KM255065   &lt;NA&gt;             3     UHURU\n60 JX517979   &lt;NA&gt;             3     UHURU\n\n# number of overall sequences with lat/long data \ncombtab_latlong &lt;- subset(combtab, lat != \"\")\nhead(combtab_latlong, 2)\n\n   X.1  X   processid            institution_storing phylum_taxID   phylum_name\n48  55 55 GBVU4382-13       Mined from GenBank, NCBI           12 Magnoliophyta\n49  56 56 GENG1220-15 Gujarat Biodiversity Gene Bank           12 Magnoliophyta\n   class_taxID    class_name order_taxID order_name family_taxID family_name\n48          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n49          41 Magnoliopsida      121216   Lamiales       148533 Acanthaceae\n   subfamily_taxID  subfamily_name genus_taxID genus_name species_taxID\n48              NA            &lt;NA&gt;      554845 Petalidium        554846\n49          480072 Thunbergioideae      273749 Thunbergia        317700\n               species_name subspecies_taxID subspecies_name\n48 Petalidium oblongifolium               NA            &lt;NA&gt;\n49   Thunbergia grandiflora               NA            &lt;NA&gt;\n   collectiondate_start collectiondate_end      lat     lon\n48                   NA                 NA -28.5536 24.7525\n49                   NA                 NA  22.3060 73.2780\n                        coord_source coord_accuracy elev      country\n48 Coordinates from country centroid             NA   NA South Africa\n49                   Garmin etrax 10             NA  130        India\n   province_state   region sector exactsite rbcL matK trnL ITS2   multi\n48           &lt;NA&gt;     &lt;NA&gt;   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n49        Gujarat Vodadara   &lt;NA&gt;      &lt;NA&gt; rbcL &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; rbcL---\n    gb_rbcL gb_matK gb_trnL gb_ITS barcode_count container\n48 FJ868916    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1      GBVU\n49 KX641599    &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;             1      GENG\n\ntable(combtab$trnL)\n\n\ntrnL \n5324 \n\nlevels(factor(combtab$trnL))\n\n[1] \"trnL\"",
    "crumbs": [
      "Geographic coverage",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Coverage by climatic zones</span>"
    ]
  },
  {
    "objectID": "geocov_figs2.html",
    "href": "geocov_figs2.html",
    "title": "Coverage by country",
    "section": "",
    "text": "This notebook analyzes the counts of barcodes by country and plots the results.\n\n## First check for the required packages, install if needed, and load the libraries.\nif (!requireNamespace(\"BiocManager\", quietly = TRUE))\n    install.packages(\"BiocManager\")\n\nBiocManager::install(\"sangerseqR\")\nremotes::install_github(\"ropensci/bold\")\n\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(taxize, maps, ggplot2, dplyr, countrycode, rgbif, data.table, raster, maps, mapproj, sf)\n\n\nSI Figure S1: Map of country counts\nStart with some data cleaning.\n\ncombtab &lt;- read.csv(\"../data/BoldPhyla_to_Families_combtab_v4.csv\")\nhead(combtab, 2)\n\n  X.1 X   processid               institution_storing phylum_taxID\n1   1 1   API120-12 Sri Ramaswamy Memorial University           12\n2   2 2 CANGI002-17      Museu Paraense Emilio Goeldi           12\n    phylum_name class_taxID    class_name order_taxID order_name family_taxID\n1 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n2 Magnoliophyta          41 Magnoliopsida      121216   Lamiales       148533\n  family_name subfamily_taxID subfamily_name genus_taxID  genus_name\n1 Acanthaceae              NA                     415894 Peristrophe\n2 Acanthaceae          264310   Acanthoideae      148534     Ruellia\n  species_taxID             species_name subspecies_taxID subspecies_name\n1        494465 Peristrophe bicalyculata               NA                \n2        632816          Ruellia inflata               NA                \n  collectiondate_start collectiondate_end lat lon coord_source coord_accuracy\n1                   NA                 NA  NA  NA                          NA\n2                   NA                 NA  NA  NA                          NA\n  elev country province_state region sector exactsite rbcL matK trnL ITS2\n1   NA                                                rbcL               \n2   NA  Brazil           Para                         rbcL matK       ITS\n           multi gb_rbcL gb_matK gb_trnL gb_ITS\n1        rbcL---                               \n2 rbcL-matK--ITS                               \n\n# Round coordiantes to nearest 1 degree\ncombtab$lat &lt;- as.numeric(as.character(combtab$lat))\ncombtab$lon &lt;- as.numeric(as.character(combtab$lon))\n\n# ggplot wrapper of map()\nworld_map &lt;- map_data(\"world\") \n\n# Build a dataframe / matrix of country counts to plot\nmyCodes &lt;- data.frame(table(combtab$country))\ncolnames(myCodes)&lt;-c(\"country\", \"n\")\n\n# Convert country names to \"Getty Thesaurus\" names for BOLD\nmyCodes$country &lt;- countrycode(myCodes$country, \"country.name\", \"country.name\") \nmyCodes$country[which(myCodes$country==\"United States\")]&lt;-\"USA\"\nmyCodes$country[which(myCodes$country==\"United Kingdom\")]&lt;-\"UK\"\nmyCodes$country[which(myCodes$country==\"Congo - Kinshasa\")]&lt;-\"Democratic Republic of the Congo\"\nmyCodes$country[which(myCodes$country==\"Congo - Brazzaville\")]&lt;-\"Republic of Congo\"\nmyCodes$country[which(myCodes$country==\"British Virgin Islands\")]&lt;-\"Virgin Islands\"\nmyCodes$country[which(myCodes$country==\"Bosnia & Herzegovina\")]&lt;-\"Bosnia and Herzegovina\"\nmyCodes$country[which(myCodes$country==\"São Tomé & Príncipe\")]&lt;-\"Sao Tome and Principe\"\nmyCodes$country[which(myCodes$country==\"Trinidad & Tobago\")]&lt;-\"Trinidad\" #Tobago is a separate entity in maps\nmyCodes$country[which(myCodes$country==\"North Macedonia\")]&lt;-\"Macedonia\" \nmyCodes$country[which(myCodes$country==\"Myanmar (Burma)\")]&lt;-\"Myanmar\" \nmyCodes$country[which(myCodes$country==\"Côte d’Ivoire\")]&lt;-\"Ivory Coast\" \nmyCodes$country[which(myCodes$country==\"Czechia\")]&lt;-\"Czech Republic\" \nmyCodes$country[which(myCodes$country==\"Réunion\")]&lt;-\"Reunion\" \nmyCodes$country[which(myCodes$country==\"St. Helena\")]&lt;-\"Saint Helena\" \nmyCodes$country[which(myCodes$country==\"Eswatini\")]&lt;-\"Swaziland\" \n\n\nMap country-level barcode intensity.\n\n# Map for country-level intensity\nmyCodes &lt;- myCodes[is.na(myCodes$country)==F,]\n\nggpoliticalboundaries &lt;- ggplot(myCodes) + geom_map(dat = world_map, map = world_map, aes(map_id = region), fill = \"white\", color = \"#7f7f7f\", size = 0.25)  +\n  geom_map(map = world_map, aes(map_id = country, fill = n), size = 0.25) +\n  scale_fill_gradient(low = \"#fff7bc\", high = \"#cc4c02\", name = \"Worldwide specimens\") + scale_x_continuous(breaks = seq(-180, 180, by = 60)) + scale_y_continuous(breaks = seq(-90, 90, by = 45)) +\n  expand_limits(x = world_map$long, y = world_map$lat) + theme_classic() + ylab(\"\") + xlab(\"\") + theme(legend.position = \"none\") +\n  geom_hline(yintercept = 0, color = \"black\", size = 0.5) + geom_hline(yintercept = 23.5, color = \"black\", linetype = \"dashed\") + \n  geom_hline(yintercept = -23.5, color = \"black\", linetype = \"dashed\") \n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\nggpoliticalboundaries\n\n\n\n\n\n\n\n#ggsave(\"ggpoliticalboundaries_20240626_1.pdf\", ggpoliticalboundaries, width = 13, height = 8.6, units = \"cm\")\n\n\n\nDistribution of country bias - barplot.\n\n# Barplot with country counts\ncountrycounts_bar &lt;- ggplot(myCodes, aes(x = reorder(country, -n), y = n)) +\n  geom_bar(stat = \"identity\", width = 0.9) + theme_classic() + xlab(\"\") + ylab(\"\") +  theme(axis.title.x=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank())\ncountrycounts_bar\n\n\n\n\n\n\n\n#ggsave(\"countrycounts_20240626.pdf\", countrycounts, width = 13, height = 4, units = \"cm\")\n\n\n\nDistribution of country bias - lineplot.\n\n# Line plot with country counts\ncountrycounts_line &lt;- ggplot(myCodes, aes(x = reorder(country, -n), y = n, group = 1)) +\n  geom_line() + theme_classic() + xlab(\"\") + ylab(\"\") +  theme(axis.title.x=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank())\ncountrycounts_line\n\n\n\n\n\n\n\n#ggsave(\"countrycounts_20240626.pdf\", countrycounts, width = 8, height = 4, units = \"cm\")\n\n\n\nPrint dataframe with countries having less than 10 barcodes.\nWe only print the first 10, but there are 38 countries total.\n\n# Summarize number of countries with &lt;10 \nmyCodes_less_than_10 &lt;- subset(myCodes, n &lt;10) %&gt;%\n  arrange(desc(n))\nmyCodes_less_than_10\n\n                                  country n\n1                              Cape Verde 9\n2                                 Eritrea 9\n3                            Sierra Leone 9\n4                                Trinidad 9\n5                                    Guam 8\n6                                 Mayotte 8\n7  South Georgia & South Sandwich Islands 8\n8                          Virgin Islands 7\n9                        Falkland Islands 7\n10                            North Korea 7\n11                           Cook Islands 6\n12                   United Arab Emirates 6\n13                                 Kosovo 5\n14                                Belarus 4\n15                                   Chad 4\n16                          Guinea-Bissau 4\n17                                 Kuwait 4\n18                                  Palau 4\n19                                Bermuda 3\n20                          Faroe Islands 3\n21                           Saint Helena 3\n22                                  Tonga 3\n23                               Djibouti 2\n24                                 Gambia 2\n25                                Grenada 2\n26                              Lithuania 2\n27                               Maldives 2\n28                                  Niger 2\n29               Northern Mariana Islands 2\n30                              St. Lucia 2\n31                             San Marino 2\n32                      Antigua & Barbuda 1\n33                                  Aruba 1\n34                             Mauritania 1\n35                                Moldova 1\n36                                   Niue 1\n37               St. Vincent & Grenadines 1\n38                            South Sudan 1",
    "crumbs": [
      "Geographic coverage",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Coverage by country</span>"
    ]
  },
  {
    "objectID": "taxonomic_coverage.html",
    "href": "taxonomic_coverage.html",
    "title": "Taxonomic Coverage",
    "section": "",
    "text": "Taxonomic Coverage\nAdd all code here and update text.",
    "crumbs": [
      "Taxonomic coverage",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Taxonomic Coverage</span>"
    ]
  },
  {
    "objectID": "fetch_gbif.html",
    "href": "fetch_gbif.html",
    "title": "Fetching plant occurrence records from GBIF",
    "section": "",
    "text": "This notebook contains code used to pull plant species occurrence records from the GBIF API.\nWe use pacman to mange the R packages and load libraries.\n\n## First check for the required packages, install if needed, and load the libraries.\nif (!requireNamespace(\"BiocManager\", quietly = TRUE))\n    install.packages(\"BiocManager\")\n\nBiocManager::install(\"sangerseqR\")\nremotes::install_github(\"ropensci/bold\")\n\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(dplyr, curl, zip, readr, rgbif, usethis, stringr)\n\n\nRead in BOLD species list and obtain GBIF keys\nThis block uses a site-specific list of species from the Yellowstone BOLD project to pull any taxon keys for those species hosted on GBIF, matched by exact scientific names.\n\nspecies_list &lt;- readr::read_csv(\"../data/BOLD_spplist_20240109.csv\") %&gt;%\n  pull(\"Species\")\n\nRows: 319 Columns: 1\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): Species\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n# Get all backbone results (without filtering)\nall_matches &lt;- name_backbone_checklist(species_list, kingdom = \"plants\")\n\nexact_key_matches &lt;- all_matches %&gt;%\n  filter(matchType == \"EXACT\") %&gt;%\n  select(usageKey) %&gt;%\n  as.list()\n\n# Find taxa that didn't match at species level.\nnot_exact_matches &lt;- all_matches %&gt;%\n  filter(matchType != \"EXACT\")\n\n\n\nInvestigate taxon keys for fuzzy matches and higher rank matches\nSome keys may indicate that local species are sharing a taxon key, or the keys returned were backed off to higher taxonomic levels. Beware that these can result in many more occurrence records matched at higher taxonomic levels. This can happen for hyper-local species with no occurrence records in GBIF. For our purposes, we kept only exact species matches.\n\n# View results\nnot_exact_matches\n\n# A tibble: 6 × 26\n  usageKey scientificName        canonicalName rank  status confidence matchType\n     &lt;int&gt; &lt;chr&gt;                 &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;    \n1  3171742 Erythranthe Spach     Erythranthe   GENUS ACCEP…         99 HIGHERRA…\n2  2704858 Calamagrostis Adans.  Calamagrostis GENUS ACCEP…         96 HIGHERRA…\n3     3064 Amaranthaceae         Amaranthaceae FAMI… ACCEP…         99 HIGHERRA…\n4  8148051 Bistorta (L.) Scop.   Bistorta      GENUS ACCEP…         99 HIGHERRA…\n5  3033620 Pulsatilla Mill.      Pulsatilla    GENUS ACCEP…         99 HIGHERRA…\n6  3087061 Oreostemma alpigenum… Oreostemma a… SPEC… ACCEP…         98 FUZZY    \n# ℹ 19 more variables: kingdom &lt;chr&gt;, phylum &lt;chr&gt;, order &lt;chr&gt;, family &lt;chr&gt;,\n#   genus &lt;chr&gt;, species &lt;chr&gt;, kingdomKey &lt;int&gt;, phylumKey &lt;int&gt;,\n#   classKey &lt;int&gt;, orderKey &lt;int&gt;, familyKey &lt;int&gt;, genusKey &lt;int&gt;,\n#   speciesKey &lt;int&gt;, synonym &lt;lgl&gt;, class &lt;chr&gt;, acceptedUsageKey &lt;int&gt;,\n#   verbatim_name &lt;chr&gt;, verbatim_index &lt;dbl&gt;, verbatim_kingdom &lt;chr&gt;\n\n\nWe had 6 species that did not match a species key, resulting in 98% of the species having data we can use from GBIF to explore global geographic coverage of these species.\n\n\nSet GBIF credentials\nThe following block will open your .Renviron file. Register an account with GBIF on their website and then add these environment variables to the .Renviron and save: GBIF_USER=“user” GBIF_PWD=“password” GBIF_EMAIL=“email”.\nAfter requesting the data based on our list of taxon keys, we will get millions of occurrence records that we can download; the data will be help in your GBIF portal.\n\nusethis::edit_r_environ()\n\n☐ Edit '/Users/tdivoll/.Renviron'.\n\n\n☐ Restart R for changes to take effect.\n\n\n\n\nRequest the occurence data\nWe’ll further restrict the data returned to records that have reliable coordinate data, and use a simple CSV format to reduce the size of the data. The Darwin Core Archive format will include much more metadata, but we’re only interested in the locations for this analysis.\n\ngbif_data_BOLDlist &lt;- occ_download(\n  pred_in(\"taxonKey\", exact_key_matches$usageKey),\n  pred(\"hasCoordinate\", TRUE),\n  pred(\"hasGeospatialIssue\", FALSE),\n  format = \"SIMPLE_CSV\"\n)\n\n\n\nGet metadata and wait\nGet the metadata about the request.\n\ngbif_data_BOLDlist # this will print some info, including the download ID we need to check on the job\n\n&lt;&lt;gbif download&gt;&gt;\n  Your download is being processed by GBIF:\n  https://www.gbif.org/occurrence/download/0067216-241126133413365\n  Most downloads finish within 15 min.\n  Check status with\n  occ_download_wait('0067216-241126133413365')\n  After it finishes, use\n  d &lt;- occ_download_get('0067216-241126133413365') %&gt;%\n    occ_download_import()\n  to retrieve your download.\nDownload Info:\n  Username: tdivoll\n  E-mail: timothy_divoll@brown.edu\n  Format: SIMPLE_CSV\n  Download key: 0067216-241126133413365\n  Created: 2025-01-13T21:36:39.215+00:00\nCitation Info:  \n  Please always cite the download DOI when using this data.\n  https://www.gbif.org/citation-guidelines\n  DOI: 10.15468/dl.w9bwwx\n  Citation:\n  GBIF Occurrence Download https://doi.org/10.15468/dl.w9bwwx Accessed from R via rgbif (https://github.com/ropensci/rgbif) on 2025-01-13\n\n\nCheck the status of the download.\n\nocc_download_wait('0066939-241126133413365')\n\nstatus: succeeded\n\n\ndownload is done, status: succeeded\n\n\n&lt;&lt;gbif download metadata&gt;&gt;\n  Status: SUCCEEDED\n  DOI: 10.15468/dl.48qedg\n  Format: SIMPLE_CSV\n  Download key: 0066939-241126133413365\n  Created: 2025-01-13T17:50:02.365+00:00\n  Modified: 2025-01-13T18:02:18.702+00:00\n  Download link: https://api.gbif.org/v1/occurrence/download/request/0066939-241126133413365.zip\n  Total records: 20510078",
    "crumbs": [
      "Case-study -- Yellowstone",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Fetching plant occurrence records from GBIF</span>"
    ]
  }
]